$toolbar-height: 44px;
$mobile-width: 768px;
$santa-color: #00c6ed;

// nb. somewhat arbitrary: "Auf den Spuren des Weihnachtsmanns" plus misc takes up ~413px on left
// using Chrome Mac 54. Thus, 1024 - (413 * 2) == 198px.
$feature-width: 198px;

:host {
  display: block;
}

:host([mode="embed"]) #drawer,
:host([mode="embed"]) .buttons,
:host([mode="embed"]) .toolbar-icon,
:host([mode="embed"]) .title,
:host([mode="embed"]) #sound  {
  display: none !important;
}

app-drawer {
  --app-drawer-width: 320px;
  --app-drawer-scrim-background: fade-out($santa-color, 0.4);
}
app-header {
  background-color: transparent;
}

.button-set:not(.alternate),
#fixed-background {
  color: var(--santa-header-color, $santa-color);
}
:host(.fixed) #fixed-background {
  visibility: visible;
}

[hidden] {
  display: none !important;
}

#fixed-background {
  // nb. The app-header layer can be manipulated, but somewhat unreliabily. This exists under it
  // and is made visible only when the host is .fixed.
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  box-shadow: 0 2px 0 rgba(0,0,0,0.25);
  background-color: currentColor;
  visibility: hidden;
}

app-drawer {
  z-index: 1;  // higher than sound button

  #main-content {
    position: relative;
    height: 100%;
  }

  .drawer-content {
    height: 100%;
    overflow: auto;
  }

  app-toolbar.close-sidebar {
    cursor: pointer;
    font-family: 'Lobster';
    font-size: 2em;
    color: #ccc;
    pointer-events: auto;

    paper-icon-button {
      margin-right: 6px;
    }
  }
}

app-toolbar {
  height: $toolbar-height;
  color: white;

  paper-icon-button[drawer-toggle] {
    margin-right: 4px;
    min-width: 40px;
    color: white;
  }

  // Common button reset.
  button {
    border: 0;
    margin: 0;
    padding: 0;
    text-align: center;
    background: transparent;
    cursor: pointer;
  }

  a.linkwrap {
    display: inline-flex;
    max-width: 100%;
    text-decoration: none;
  }

  #logo {
    width: 62px;
    min-width: 62px;
    background: url(img/google_logo.svg) 0 14px no-repeat;
    background-size: contain;
  }

  h1 {
    padding-left: 4px;
    margin: 0;
    font-family: 'Lobster', sans-serif;
    font-size: 19px;
    line-height: $toolbar-height;
    font-weight: 300;
    color: white;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .title {
    height: 100%;
    min-width: 1px;  // nb. without any min-width, title can't be clipped to size
    flex-grow: 1;
  }

  .feature {
    z-index: 10;
    height: 100%;
    text-align: center;
    position: relative;
  }

  .buttons {
    padding: ($toolbar-height - 40px)/2 0;  // icon=40px, total=$toolbar-height;
    height: 100%;
    box-sizing: border-box;
    display: var(--link-display, flex);
    justify-content: flex-end;
    font-size: 0;  // fixes alignment issues

    paper-icon-button#gplus {
      padding: 4px;
    }

//    .sep {
//      background: rgba(0,0,0,0.125);
//      width: 1px;
//      margin: 6px;
//
//      &:first-child {
//        visibility: hidden;
//      }
//    }
  }
  .buttons-overflow {
    position: absolute;
    top: 44px;
    right: 16px;
    display: flex;
    flex-flow: column;
    will-change: transform, opacity;
    z-index: -1;
    transition: transform 0.33s, opacity 0.33s;

    paper-icon-button {
      margin-top: 12px;
      background: var(--santa-feature-color, #00e8bf);
      border-radius: 1000px;
      color: white;
      box-shadow: 0 2px 0 rgba(0, 0, 0, 0.3);
      will-change: transform;
      transition: transform 0.1s;

      &::after {
        // nb. this increases the mouse target for the icon, but is otherwise invisible
        z-index: -2;
        content: attr(data-title);
        color: transparent;
        position: absolute;
        right: -4px;
        top: -4px;
        bottom: -4px;
        border-radius: 10000px;
        padding-right: 66px;
        padding-left: 8px;
        font-size: 14px;
      }

      &::before {
        content: attr(data-title);
        position: absolute;
        right: 100%;
        margin-right: 12px;
        display: flex;
        align-items: center;
        top: 8px;
        bottom: 8px;
        padding: 4px 6px;
        box-sizing: border-box;
        background: rgba(0, 0, 0, 0.5);
        box-shadow: 0 2px 0 rgba(0, 0, 0, 0.05);
        border-radius: 2px;
        color: white;
        font-size: 14px;
        font-weight: 500;
        opacity: 0;
        pointer-events: none;
        will-change: opacity;
        transition: opacity 0.125s;
      }
      &:hover::before {
        opacity: 1;
      }
    }

    @for $i from 1 through 10 {
      :nth-child(#{$i}) {
        transition-delay: 0.04s * ($i - 1);
      }
    }

    @keyframes hold {
      from { visibility: visible; }
      to   { visibility: visible; }
    }

    &.fade {
      pointer-events: none;
      animation: hold 0.33s;
      visibility: hidden;
      opacity: 0.33;
      paper-icon-button {
        transform: scale(0);
        transition-delay: 0s !important;
      }
    }
  }

  /**
   * In the full village experience, make the left/right (.title/.buttons respectively) grow to the
   * same center point.
   */
  @media (min-width: $mobile-width) {
    .title {
      width: 69px - 44px;
    }
    .feature:not([hidden]) + .buttons {
      // where there's a feature, grow the right-hand side (sharer)
      width: 69px;
      flex-grow: 1;
    }
    .feature {
      // .. and the feature has a min-width set, for future scores/times etc
      min-width: $feature-width;
    }
  }
}

